var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(a,c,d){var b=this.length||0;0>c&&(c=Math.max(0,b+c));if(null==d||d>b)d=b;d=Number(d);0>d&&(d=Math.max(0,b+d));for(c=Number(c||0);c<d;c++)this[c]=a;return this}},"es6","es3");var pwell={postContainer:{}};"undefined"==typeof pwell&&(pwell={});
pwell.PostContainer=function(){var a=this;this.posts=[];this.element=$(".post-container")[0];this.postIds=[];this.position=0;this.top=null;this.contentNavigator=new pwell.ContentNavigator;setTimeout(function(){a.updatePosts()},5E3);setInterval(function(){var b=null,c;for(c in a.postIds){var d=a.postIds[c];a.posts[d]&&(b||(b=a.posts[d]),a.posts[d].element.getBoundingClientRect().y<.6*window.innerHeight&&(b=a.posts[d]),a.posts[d].element.classList.remove("em"))}b!==a.top&&a.contentNavigator.update(b.data);
b.element.classList.add("em");a.top=b},1E3)};
pwell.PostContainer.prototype.updatePosts=function(){var a=this;pwell.rest.getPostIds({success:function(b,c){a.postIds=c;if(a.posts.length<pwell.settings.maxPosts){b=0;c=$jscomp.makeIterator(a.postIds);for(var d=c.next();!d.done;d=c.next()){var e=d.value;!a.posts[e]&&b<pwell.settings.maxPosts&&(b++,pwell.rest.getPost(e,{success:function(b,c){"Operation successful"===b&&(b=new pwell.Post(c),a.insert(b))},error:function(b,c){"Not Found"===b?(a.postIds.splice(e,1),console.error(b+" id:"+e)):console.error(b)}}))}}},
error:function(a){console.error(a)}})};pwell.PostContainer.prototype.remove=function(a){a&&this.posts[a.data.id]&&(delete this.posts[a.id],this.element.removeChild(a.getHTMLElement()))};
pwell.PostContainer.prototype.insert=function(a){var b=a.data.id,c=null;if(-1===b)this.element.prepend(a.getHTMLElement());else{for(b=this.postIds.indexOf(+b)+1;b<this.postIds.length;b++)this.posts[this.postIds[b]]&&(c=this.posts[this.postIds[b]]);c?(this.posts[a.data.id]=a,this.element.insertBefore(a.getHTMLElement(),c.getHTMLElement())):this.append(a)}pwell.controller.updateUI()};pwell.PostContainer.prototype.append=function(a){this.element.append(a.getHTMLElement());this.posts[a.data.id]=a};(function(){function a(a){a=a.replace(/\u00d7/g,"&times;").replace(/\u00ab/g,"&laquo;").replace(/\u00bb/g,"&raquo;").replace(/\u2190/g,"&larr;").replace(/\u2192/g,"&rarr;");a=a.split(/\n/);a.shift();a.splice(-1,1);var b=a[0].length-a[0].trim().length,c=new RegExp(" {"+b+"}");a=a.map(function(a){a.match(c)&&(a=a.substring(b));return a});return a=a.join("\n")}$(window).scroll(function(){var a=$(document).scrollTop();$(".splash").css({"background-position":"0px -"+(a/3).toFixed(2)+"px"});50<a?$("#home > .navbar").removeClass("navbar-transparent"):
$("#home > .navbar").addClass("navbar-transparent")});$("a[href='#']").click(function(a){a.preventDefault()});var b=$("<div id='source-button' class='btn btn-primary btn-xs'>&lt; &gt;</div>").click(function(){var b=$(this).parent().html();b=a(b);$("#source-modal pre").text(b);$("#source-modal").modal()});$('.bs-component [data-toggle="popover"]').popover();$('.bs-component [data-toggle="tooltip"]').tooltip();$(".bs-component").hover(function(){$(this).append(b);b.show()},function(){b.hide()})})();pwell.contentNavigator={};"undefined"==typeof pwell&&(pwell={});pwell.ContentNavigator=function(){this.element=$($(".content-navigation")[0]);this.titleDisplay=this.element.find(".post-navigator-title")[0];this.breadcrumbsDisplay=this.element.find(".post-navigator-index")[0]};
pwell.ContentNavigator.prototype.update=function(a){var b="";if(20<a.title.length){for(var c=a.title.split(""),d=!1,e=16;15<e;e--)if(" "===c[e]){d=!0;b=c.join("").slice(0,e)+" ...";break}d||(b=c.join("").slice(0,16)+"...")}else b=a.title;this.titleDisplay.innerHTML=b;b="";for(var f in a.headings)b+="<li><a href='#p"+a.id+"_"+f+"'>"+a.headings[f]+"</a></li>";this.breadcrumbsDisplay.innerHTML="<ul>"+b+"</ul>"};"undefined"==typeof pwell&&(pwell={});pwell.rest={};pwell.rest.login=function(a,b,c,d){null==d&&(d={error:function(){},success:function(){}});this.defaultRequest({url:"Rest/user/login",method:"POST",data:{username:a,password:b,"g-recaptcha-response":c},success:d.success,error:d.error})};pwell.rest.logout=function(a){null==a&&(a={error:function(){},success:function(){}});this.defaultRequest({url:"/Rest/user/logout",method:"GET",success:a.success,error:a.error})};
pwell.rest.register=function(a,b,c,d,e){null==e&&(e={error:function(){},success:function(){}});this.defaultRequest({url:"Rest/user/register",method:"POST",data:{username:a,password:b,email:c,"g-recaptcha-response":d},success:e.success,error:e.error})};pwell.rest.getPost=function(a,b){null==b&&(b={error:function(){},success:function(){}});this.defaultRequest({url:"Rest/posts/"+a,method:"GET",success:b.success,error:b.error})};
pwell.rest.getPostIds=function(a){null==a&&(a={error:function(){},success:function(){}});this.defaultRequest({url:"Rest/posts",method:"GET",success:a.success,error:a.error})};pwell.rest.createPost=function(a,b,c){null==c&&(c={error:function(){},success:function(){}});a="data="+encodeURIComponent(JSON.stringify({title:a,text:b}));this.defaultRequest({url:"Rest/posts/",method:"PUT",data:a,success:c.success,error:c.error})};
pwell.rest.editPost=function(a,b,c,d){null==d&&(d={error:function(){},success:function(){}});b="data="+encodeURIComponent(JSON.stringify({title:b,text:c}));this.defaultRequest({url:"Rest/posts/"+a,data:b,method:"POST",success:d.success,error:d.error})};pwell.rest.deletePost=function(a,b){null==b&&(b={error:function(){},success:function(){}});this.defaultRequest({url:"Rest/posts/"+a,method:"DELETE",success:b.success,error:b.error})};
pwell.rest.getUserInfo=function(a){null==a&&(a={error:function(){},success:function(){}});this.defaultRequest({url:"Rest/user/info",method:"GET",success:a.success,error:a.error})};pwell.rest.getSelfInfo=function(a){null==a&&(a={error:function(){},success:function(){}});this.defaultRequest({url:"Rest/user/info",method:"GET",success:a.success,error:a.error})};
pwell.rest.autoCompleteUser=function(a,b){null==b&&(b={error:function(){},success:function(){}});this.defaultRequest({url:"Rest/user/info",method:"GET",success:b.success,error:b.error})};pwell.rest.getUserPerms=function(a,b){null==b&&(b={error:function(){},success:function(){}});this.defaultRequest({url:"Rest/user/info",method:"GET",success:b.success,error:b.error})};
pwell.rest.setUserPerms=function(a,b,c){null==c&&(c={error:function(){},success:function(){}});this.defaultRequest({url:"Rest/user/info",method:"GET",success:c.success,error:c.error})};
pwell.rest.defaultRequest=function(a){null==a&&(a={error:function(){},success:function(){}});$.ajax({type:a.method,url:a.url,dataType:"json",data:a.data,success:function(b){var c=null,d="Operation successful";b&&("string"===typeof b.msg&&0<b.msg&&(d=b.msg),"object"===typeof b.data&&(c=b.data));"function"===typeof a.success&&a.success(d,c)},error:function(b,c,d){c=d;d=null;b.responseJSON&&("string"===typeof b.responseJSON.msg&&0<b.responseJSON.msg&&(c=b.responseJSON.msg),"object"===typeof b.responseJSON.data&&
(d=b.responseJSON.data));"function"===typeof a.error&&a.error(c,d)}})};pwell.controller={};"undefined"==typeof pwell&&(pwell={});pwell.Controller=function(){this.loggedin=!1;this.permissions={};this.currentUserId=0;this.postContainer=null};pwell.Controller.prototype.logout=function(){var a=this;pwell.rest.logout({success:function(){a.updateLoginInfo()}})};
pwell.Controller.prototype.updateUI=function(){var a=this,b=$(".login-buttons"),c=$(".user-info"),d=c.find(".name-field");this.loggedin?(b.hide(),c.show(),d.html(this.name)):(b.show(),c.hide());$(".require_perm").each(function(){var b=!1,c;for(c in a.permissions)if($(this).hasClass(c)&&a.permissions[c]){$(this).show();b=!0;break}b||$(this).hide()})};
pwell.Controller.prototype.updateLoginInfo=function(){var a=this;pwell.rest.getSelfInfo({success:function(b,c){a.loggedin=c.status;a.name=c.name;a.email=c.email;a.permissions=c.permissions;a.updateUI()},error:function(){console.log("error: checkingLoginInfo")}})};pwell.Controller.prototype.createNewPost=function(){var a=new pwell.Post({id:-1,title:"asd",text:"asd"});pwell.controller.postContainer.insert(a);a.enableEditing()};
$(document).ready(function(){$(".content-navigation").sticky();pwell.controller=new pwell.Controller;pwell.controller.updateLoginInfo();pwell.modalController=new pwell.ModalController;void 0==pwell.settings&&(console.log("Server failed to deliver settings. switching to defaults"),pwell.settings={},pwell.settings.maxPosts=5,pwell.settings.loadLastestPosts=!0);pwell.controller.postContainer=new pwell.PostContainer;pwell.controller.postContainer.updatePosts()});var canvas,actions=0,ctx,targetTime=32,elements=[];$(document).ready(function(){if(canvas=document.getElementById("bubbles"))canvas.width=345,canvas.height=345,ctx=canvas.getContext("2d"),setTimeout(function(){for(var a=0;100>a;a++)elements[a]=new Dot(canvas.width*Math.random(),canvas.height*Math.random());setInterval(run,targetTime)},10)});document.addEventListener("mousemove",function(){actions++});
var run=function(){ctx.fillStyle=16777215;var a=.1;ctx.clearRect(0,0,canvas.width,canvas.height);for(var b=0;b<elements.length;b++)a+=.002*actions,elements[b].update(a);for(a=0;a<elements.length;a++)elements[a].render();dataUrl=canvas.toDataURL();ele=document.getElementsByClassName("bubbles");for(a=0;a<ele.length;a++)ele[a].style.background="url('"+dataUrl+"')";actions=0},Dot=function(a,b){this.posX=a;this.posY=b;this.velX=-5+10*Math.random();this.velY=-5+10*Math.random();this.size=2+9*Math.random()};
function circle(a,b,c){ctx.beginPath();ctx.arc(a,b,c,0,2*Math.PI,!1);ctx.fill();ctx.lineWidth=1;ctx.strokeStyle="#003300";ctx.stroke()}
Dot.prototype.render=function(){0>this.posX-this.size&&circle(canvas.width+this.posX,this.posY,this.size);this.posX+this.size>canvas.width&&circle(this.posX-canvas.width,this.posY,this.size);0>this.posY-this.size&&circle(this.posX,canvas.height+this.posY,this.size);this.posY+this.size>canvas.height&&circle(this.posX,this.posY-canvas.height,this.size);circle(this.posX,this.posY,this.size)};
Dot.prototype.update=function(a){this.posX>canvas.width?this.posX-=canvas.width:0>this.posX&&(this.posX+=canvas.width);this.posY>canvas.height?this.posY-=canvas.height:0>this.posY&&(this.posY+=canvas.height);this.posX+=this.velX*a;this.posY+=this.velY*a};"undefined"==typeof pwell&&(pwell={});
pwell.AjaxForm=function(a,b,c,d){var e=this;this.callback=d?d:function(){};this.FormSelector=a;this.url=b;this.initialHeight=this.TimeoutId=this.status=0;this.ElementForm=$(a);this.EFormResponse=this.ElementForm.find(".form-response");this.ElementForm.resize(function(){0==e.status&&3==e.status&&e.EFormResponse.css("margin-top",-e.EFormResponse.outerHeight())});this.ElementForm.submit(function(a){a.preventDefault();a=e.ElementForm.serializeArray();var b={},d;for(d in a)b[a[d].name]=a[d].value;pwell.rest.login(b.username,
b.password,b["g-recaptcha-response"],{error:function(a,b){e.showResponse("failure",a);e.TimeoutId=setTimeout(function(){e.hideResponse()},1E4)},success:function(a,b){2==e.status?(clearTimeout(e.TimeoutId),e.hideResponse(function(){e.showResponse("success",a)})):e.showResponse("success",a);e.callback({status:"success",event:b});"undefined"!=typeof captchas&&"undefined"!=typeof grecaptcha&&e.useCaptcha&&grecaptcha.reset(c);e.TimeoutId=setTimeout(function(){e.hideResponse()},1E4)}})})};
pwell.AjaxForm.prototype.showResponse=function(a,b,c){var d=this;"undefined"==typeof c&&(c=function(){});0==this.status&&(this.status=1,this.EFormResponse[0].innerHTML=b,d.EFormResponse.css("margin-top",-d.EFormResponse.outerHeight()),"success"==a&&this.EFormResponse.addClass("form-response-success"),"failure"==a&&this.EFormResponse.addClass("form-response-failure"),d.EFormResponse.animate({marginTop:0},500,"easeOutExpo",function(){d.status=2;c(!0)}))};
pwell.AjaxForm.prototype.hideResponse=function(a){var b=this;"undefined"==typeof a&&(a=function(){});2==this.status&&(this.status=3,this.EFormResponse[0].innerHTML="",this.EFormResponse.animate({marginTop:-this.EFormResponse.outerHeight()},500,"easeOutExpo",function(){b.status=0;b.EFormResponse.removeClass("form-response-failure form-response-success");a(!1)}))};
pwell.ModalForm=function(a,b,c,d,e){var f=this;this.ElementModal=$(a);this.captcha=this.ElementModal.find(".captcha");this.captchaId=0;this.initialized=!1;this.useCaptcha=void 0!==e?e:!1;if(0!=this.captcha.length&&e)this.ElementModal.on("shown.bs.modal",function(){f.initialized||(f.captchaId=captchas[captchas.length]=grecaptcha.render(f.captcha[0].getAttribute("id"),{sitekey:pwell.settings.siteKey,size:"normal"}),f.initialized=!0)});pwell.AjaxForm.call(this,b,c,e?this.captchaId:0,d)};
pwell.ModalForm.prototype=Object.create(pwell.AjaxForm.prototype);pwell.ModalForm.prototype.constructor=pwell.ModalForm;var captchas=[];
$(document).ready(function(){new pwell.ModalForm("#login","#LoginForm","/REST/user/login",function(a){"success"===a.status&&"undefined"!==typeof pwell.controller&&"undefined"!==typeof pwell.controller.updateLoginInfo&&(pwell.controller.updateLoginInfo(),pwell.controller.updateUI())},!0);new pwell.ModalForm("#register","#RegisterForm","/REST/user/register",null,!0);new pwell.ModalForm("#manageUser","#ManageUserForm","/REST/user/info",function(a){if("success"===a.status&&(a=a.event,"success"==a.status)){var b=
"",c;for(c in a.data)b+="<div class='row'> <div class='col-xs-2' style='text-transform: capitalize'>"+c+"</div><div class='col-xs-10'>"+a.data[c]+"</div></div>";pwell.modalController.userId=a.data.id;pwell.modalController.username=a.data.name;$("#manageUser").find(".content")[0].innerHTML=b;$(".actionButtons").find("button").removeClass("disabled")}});new pwell.ModalForm("#permission","#PermissionForm","/Api/setPerms")});pwell.modalController={};"undefined"===typeof pwell&&(pwell={});pwell.ModalController=function(){this.userId=0;this.username=""};pwell.ModalController.prototype.confirmBan=function(){$("#ban")};pwell.ModalController.prototype.confirmDelete=function(){$("#delete")};
pwell.ModalController.prototype.permission=function(){var a=this,b=$("#permission");$.ajax({type:"POST",url:"/Api/getPerms",dataType:"json",data:"id="+a.userId,success:function(c){c=c.data;var d="",e;for(e in c)d+="<div class='row'><div class='col-xs-4'>"+e+":</div><input type='hidden' value='0' name='"+e+"'><input type='checkbox' value='1' name='"+e+"' class='col-xs-2' "+(1==c[e]?"checked":"")+"></div>";b.find("input.id")[0].value=a.userId;b.find(".content")[0].innerHTML=d;b.find(".username")[0].innerHTML=
a.username;b.modal("show")}})};pwell.post={};"undefined"==typeof pwell&&(pwell={});pwell.Post=function(a){this.data=a;this.element=null;this.buttons={};this.editor=null;this.buttons={}};
pwell.Post.prototype.getHTMLElement=function(){if(!this.element){var a=document.createElement("div");a.innerHTML=this.template();var b=this;this.element=a.firstChild;this.buttons={};this.buttons.postEditButton=this.element.getElementsByClassName("post-edit")[0];this.buttons.postEditFinishedButton=this.element.getElementsByClassName("post-edit-finished")[0];this.buttons.postDeleteButton=this.element.getElementsByClassName("post-delete")[0];this.buttons.postEditButton.addEventListener("click",function(){b.enableEditing()});
this.buttons.postEditFinishedButton.addEventListener("click",function(){b.disableEditing();-1===b.data.id?pwell.rest.createPost(b.data.title,b.data.text,{success:function(){b.destroy()}}):pwell.rest.editPost(b.data.id,b.data.title,b.data.text,{error:function(a,b){console.log(arguments)}})});this.buttons.postDeleteButton.addEventListener("click",function(){b.destroy();pwell.rest.deletePost(b.data.id,{error:function(a,b){console.log(arguments)}})})}return this.element};
pwell.Post.prototype.destroy=function(){pwell.controller.postContainer.remove(this)};
pwell.Post.prototype.template=function(){return void 0!=pwell.postTemplate?pwell.postTemplate(this.data):'<div class="content spacer row post"><div><h1 class="post-title clear-fix">'+this.data.title+'</h1><div class="underline"></div><div class="post-meta"><span class="post-author">'+this.data.author+'</span> ~ <span class="post-date">'+this.data.date_changed+'</span></div></div><div class="post-text">'+this.data.text+"</div></div>"};
pwell.Post.prototype.enableEditing=function(){var a=this.element;this.buttons.postEditFinishedButton.classList.remove("hidden");this.buttons.postEditButton.classList.add("hidden");var b=a.getElementsByClassName("post-title")[0];a=a.getElementsByClassName("post-text")[0];b.classList.add("editable");b.setAttribute("contentEditable","true");this.editor=new Quill(a,{modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],
[{script:"sub"},{script:"super"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],["clean"]]},theme:"snow"})};
pwell.Post.prototype.disableEditing=function(){this.buttons.postEditButton.classList.remove("hidden");this.buttons.postEditFinishedButton.classList.add("hidden");if(null!=this.editor){var a=this.editor.root.innerHTML,b=this.element.getElementsByClassName("post-title")[0].innerHTML;this.data.title=b;this.data.text=a;$(this.element).find(".ql-toolbar")[0].remove();$(this.element).find(".post-title").removeClass("editable");$(this.element).find(".post-title").attr("contenteditable","false");$(this.element).find(".post-text").removeClass("ql-container");
$(this.element).find(".post-text").removeClass("ql-snow");$(this.element).find(".ql-editor").attr("contenteditable","false");$(this.element).find(".post-text").append($(".ql-editor").children());$(this.element).find(".ql-editor")[0].remove();$(this.element).find(".ql-clipboard")[0].remove();$(this.element).find(".ql-tooltip")[0].remove()}};
